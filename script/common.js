"use strict";

function _classCallCheck(a, b) {
    if (!(a instanceof b)) throw new TypeError("Cannot call a class as a function")
}

function _defineProperties(a, b) {
    for (var c, d = 0; d < b.length; d++) c = b[d], c.enumerable = c.enumerable || !1, c.configurable = !0, "value" in c && (c.writable = !0), Object.defineProperty(a, c.key, c)
}

function _createClass(a, b, c) {
    return b && _defineProperties(a.prototype, b), c && _defineProperties(a, c), a
}
var SCROLL = function () {
        function a(b) {
            var c, d = this;
            _classCallCheck(this, a), "string" == typeof b.el ? this.el = document.querySelector(b.el) : b.el instanceof HTMLElement && (this.el = b.el), this.top = null !== (c = b.top) && void 0 !== c ? c : this.el.offsetTop, this.el.style.position = "fixed", this.unit = b.unit, this.el.style.top = this.scrollNumber() + "px", window.addEventListener("scroll", function () {
                return d.scroll()
            }), window.addEventListener("resize", function () {
                return d.scroll()
            })
        }
        return _createClass(a, [{
            key: "scroll",
            value: function scroll() {
                this.window = this.scrollNumber(), this.el.style.top = 0 < this.window - pageYOffset ? this.window - pageYOffset + "px" : 0
            }
        }, {
            key: "scrollNumber",
            value: function scrollNumber() {
                return "px" == this.unit ? 0 <= this.top ? this.top : 0 : "%" == this.unit || null == this.unit ? this.calc(window.innerHeight, this.top) - this.el.clientHeight : void 0
            }
        }, {
            key: "calc",
            value: function calc(a, b) {
                return a * b / 100
            }
        }]), a
    }(),
    myScroll = new SCROLL({
        el: ".header__nav",
        unit: "px"
    }),
    burger = document.querySelector(".header__burger"),
    list = document.querySelector(".header__nav-list"),
    bg = document.querySelector(".bg");
burger.addEventListener("click", function () {
    list.classList.toggle("active"), burger.classList.toggle("active"), bg.classList.toggle("active"), document.body.style.overflow = "hidden", burger.classList.contains("active") || (document.body.style.overflow = "visible")
}), bg.addEventListener("click", function () {
    list.classList.remove("active"), burger.classList.remove("active"), bg.classList.remove("active"), document.body.style.overflow = "visible"
});
var previewBtn = document.querySelector(".preview__btn"),
    videoBg = document.querySelector(".video"),
    video = document.querySelector(".video__film"),
    videoClose = document.querySelector(".video__close"),
    volume = document.querySelector(".controls__volume"),
    videoCurrent = document.querySelector(".controls__current"),
    videoDuration = document.querySelector(".controls__duration"),
    videoProgress = document.querySelector(".controls__progress"),
    videoFill = document.querySelector(".controls__fill"),
    videoRuler = document.querySelector(".controls__ruler");
document.querySelector(".controls__play").onclick = videoPlay, document.querySelector(".controls__pause").onclick = videoPause, document.querySelector(".controls__stop").onclick = videoStop, document.querySelector(".controls__slow").onclick = speedDown, document.querySelector(".controls__normal").onclick = speedNormal, document.querySelector(".controls__fast").onclick = speedUp, previewBtn.addEventListener("click", function (a) {
    a.preventDefault(), videoBg.classList.add("active"), video.currentTime = 0, video.muted = !1, video.pause(), document.body.style.overflow = "hidden"
}), videoClose.addEventListener("click", function () {
    videoBg.classList.remove("active"), document.body.style.overflow = "visible", video.muted = !0, speedNormal()
}), document.body.addEventListener("keydown", function (a) {
    videoBg.classList.contains("active") && "27" == a.which && (videoBg.classList.remove("active"), video.muted = !0, document.body.style.overflowY = "visible")
}), document.body.addEventListener("keydown", function (a) {
    a.preventDefault(), videoBg.classList.contains("active") && "Space" == a.code && (video.paused ? videoPlay() : videoPause())
});
var cV = "controls__volume",
    cVS = "controls__volume-slash";
volume.addEventListener("click", function () {
    volume.classList.contains(cV) ? (video.muted = !0, volume.classList.remove(cV), volume.classList.add(cVS)) : (video.muted = !1, volume.classList.remove(cVS), volume.classList.add(cV))
}), video.ondblclick = function () {
    return video.paused ? video.play() : video.pause()
};
var addZero = function (a) {
        return 10 > a ? "0" + a : a
    },
    translateTime = function (a) {
        return "".concat(Math.trunc(a / 3600), ":").concat(addZero(Math.trunc(a / 60)), ":").concat(addZero(Math.trunc(a) % 60))
    },
    currentChangeTime = function () {
        return videoCurrent.innerHTML = translateTime(video.currentTime)
    };
video.ontimeupdate = function () {
    videoFill.style.width = "".concat(video.currentTime / (video.duration / 100), "%"), currentChangeTime()
}, videoProgress.addEventListener("click", function (a) {
    if (a.target != videoRuler) {
        videoFill.style.width = "".concat(a.offsetX, "px");
        var b = a.offsetX / videoProgress.clientWidth;
        video.currentTime = video.duration * b
    }
});

function videoPlay() {
    video.play(), videoDuration.innerHTML = translateTime(video.duration)
}

function videoPause() {
    video.pause()
}

function videoStop() {
    video.pause(), video.currentTime = 0
}

function speedDown() {
    video.play(), video.playbackRate = .5
}

function speedNormal() {
    video.play(), video.playbackRate = 1
}

function speedUp() {
    video.play(), video.playbackRate = 2
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvc2Nyb2xsLmpzIiwiY29tcG9uZW50cy9uYXYuanMiLCJjb21tb24uanMiLCJjb21wb25lbnRzL3BsYXllci5qcyJdLCJuYW1lcyI6WyJTQ1JPTEwiLCJzZXQiLCJlbCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIkhUTUxFbGVtZW50IiwidG9wIiwib2Zmc2V0VG9wIiwic3R5bGUiLCJwb3NpdGlvbiIsInVuaXQiLCJzY3JvbGxOdW1iZXIiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwic2Nyb2xsIiwicGFnZVlPZmZzZXQiLCJjYWxjIiwiaW5uZXJIZWlnaHQiLCJjbGllbnRIZWlnaHQiLCJoZWlnaHQiLCJteVNjcm9sbCIsImJ1cmdlciIsImxpc3QiLCJiZyIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImJvZHkiLCJvdmVyZmxvdyIsImNvbnRhaW5zIiwicmVtb3ZlIiwicHJldmlld0J0biIsInZpZGVvQmciLCJ2aWRlbyIsInZpZGVvQ2xvc2UiLCJ2b2x1bWUiLCJ2aWRlb0N1cnJlbnQiLCJ2aWRlb0R1cmF0aW9uIiwidmlkZW9Qcm9ncmVzcyIsInZpZGVvRmlsbCIsInZpZGVvUnVsZXIiLCJvbmNsaWNrIiwidmlkZW9QbGF5IiwidmlkZW9QYXVzZSIsInZpZGVvU3RvcCIsInNwZWVkRG93biIsInNwZWVkTm9ybWFsIiwic3BlZWRVcCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImFkZCIsImN1cnJlbnRUaW1lIiwibXV0ZWQiLCJwYXVzZSIsImV2ZW50Iiwid2hpY2giLCJvdmVyZmxvd1kiLCJjb2RlIiwicGF1c2VkIiwiY1YiLCJjVlMiLCJvbmRibGNsaWNrIiwicGxheSIsImFkZFplcm8iLCJudW0iLCJ0cmFuc2xhdGVUaW1lIiwidGltZSIsIk1hdGgiLCJ0cnVuYyIsImN1cnJlbnRDaGFuZ2VUaW1lIiwiaW5uZXJIVE1MIiwib250aW1ldXBkYXRlIiwid2lkdGgiLCJkdXJhdGlvbiIsInRhcmdldCIsIm9mZnNldFgiLCJk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VCxDQUFBQSxTQUFBLEVBQUEsQ0FDQVgsS0FBQSxDQUFBb0IsS0FBQSxFQURBLENBRUFwQixLQUFBLENBQUFrQixXQUFBLENBQUEsQ0FDQSxDQUVBLFFBQUFOLENBQUFBLFNBQUEsRUFBQSxDQUNBWixLQUFBLENBQUE2QixJQUFBLEVBREEsQ0FFQTdCLEtBQUEsQ0FBQTZDLFlBQUEsQ0FBQSxFQUNBLENBQ0EsUUFBQWhDLENBQUFBLFdBQUEsRUFBQSxDQUNBYixLQUFBLENBQUE2QixJQUFBLEVBREEsQ0FFQTdCLEtBQUEsQ0FBQTZDLFlBQUEsQ0FBQSxDQUNBLENBQ0EsUUFBQS9CLENBQUFBLE9BQUEsRUFBQSxDQUNBZCxLQUFBLENBQUE2QixJQUFBLEVBREEsQ0FFQTdCLEtBQUEsQ0FBQTZDLFlBQUEsQ0FBQSxDQUNBIiwiZmlsZSI6ImNvbW1vbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFNDUk9MTHtcclxuICAgIGNvbnN0cnVjdG9yKHNldCkge1xyXG4gICAgICAgIGlmKHR5cGVvZiBzZXQuZWwgPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgdGhpcy5lbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2V0LmVsKTtcclxuICAgICAgICB9ZWxzZSBpZihzZXQuZWwgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsID0gc2V0LmVsXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudG9wID0gc2V0LnRvcCA/PyB0aGlzLmVsLm9mZnNldFRvcDtcclxuICAgICAgICB0aGlzLmVsLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcclxuICAgICAgICB0aGlzLnVuaXQgPSBzZXQudW5pdDtcclxuICAgICAgICB0aGlzLmVsLnN0eWxlLnRvcCA9IHRoaXMuc2Nyb2xsTnVtYmVyKCkgKyAncHgnO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCAoKSA9PiB0aGlzLnNjcm9sbCgpKTtcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCkgPT4gdGhpcy5zY3JvbGwoKSk7XHJcbiAgICB9XHJcbiAgICBzY3JvbGwoKSB7XHJcblxyXG4gICAgICAgIHRoaXMud2luZG93ID0gdGhpcy5zY3JvbGxOdW1iZXIoKTtcclxuICAgICAgICBpZih0aGlzLndpbmRvdyAtIHBhZ2VZT2Zmc2V0ID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsLnN0eWxlLnRvcCA9IHRoaXMud2luZG93IC0gcGFnZVlPZmZzZXQgKyAncHgnO1xyXG4gICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5lbC5zdHlsZS50b3AgPSAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHNjcm9sbE51bWJlcigpIHtcclxuICAgICAgICBpZih0aGlzLnVuaXQgPT0gJ3B4Jykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50b3AgPj0gMCA/IHRoaXMudG9wIDogMDtcclxuICAgICAgICB9ZWxzZSBpZih0aGlzLnVuaXQgPT0gJyUnIHx8IHRoaXMudW5pdCA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FsYyh3aW5kb3cuaW5uZXJIZWlnaHQsdGhpcy50b3ApIC0gdGhpcy5lbC5jbGllbnRIZWlnaHQ7XHJcbiAgICAgICAgfSBcclxuICAgIH1cclxuICAgIFxyXG4gICAgY2FsYyhoZWlnaHQsdG9wKSB7XHJcbiAgICAgIHJldHVybiAgaGVpZ2h0ICogdG9wIC8gMTAwO1xyXG4gICAgfVxyXG4gICAgXHJcbn1cclxuXHJcblxyXG5sZXQgbXlTY3JvbGwgPSBuZXcgU0NST0xMKHtcclxuICAgIGVsOiAnLmhlYWRlcl9fbmF2JyxcclxuICAgIHVuaXQ6ICdweCdcclxufSkiLCJsZXQgYnVyZ2VyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9fYnVyZ2VyJyksXHJcbiAgICBsaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9fbmF2LWxpc3QnKSxcclxuICAgIGJnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJnJyk7XHJcblxyXG5cclxuYnVyZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICBsaXN0LmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpO1xyXG4gICAgYnVyZ2VyLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpO1xyXG4gICAgYmcuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJylcclxuICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcclxuICAgIGlmKCFidXJnZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSkge1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAndmlzaWJsZSc7XHJcbiAgICB9XHJcbn0pXHJcblxyXG5iZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgbGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxyXG4gICAgYnVyZ2VyLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXHJcbiAgICBiZy5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxyXG4gICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICd2aXNpYmxlJztcclxufSlcclxuIiwiY2xhc3MgU0NST0xMe1xyXG4gICAgY29uc3RydWN0b3Ioc2V0KSB7XHJcbiAgICAgICAgaWYodHlwZW9mIHNldC5lbCA9PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICB0aGlzLmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZXQuZWwpO1xyXG4gICAgICAgIH1lbHNlIGlmKHNldC5lbCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWwgPSBzZXQuZWxcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy50b3AgPSBzZXQudG9wID8/IHRoaXMuZWwub2Zmc2V0VG9wO1xyXG4gICAgICAgIHRoaXMuZWwuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnO1xyXG4gICAgICAgIHRoaXMudW5pdCA9IHNldC51bml0O1xyXG4gICAgICAgIHRoaXMuZWwuc3R5bGUudG9wID0gdGhpcy5zY3JvbGxOdW1iZXIoKSArICdweCc7XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsICgpID0+IHRoaXMuc2Nyb2xsKCkpO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKSA9PiB0aGlzLnNjcm9sbCgpKTtcclxuICAgIH1cclxuICAgIHNjcm9sbCgpIHtcclxuXHJcbiAgICAgICAgdGhpcy53aW5kb3cgPSB0aGlzLnNjcm9sbE51bWJlcigpO1xyXG4gICAgICAgIGlmKHRoaXMud2luZG93IC0gcGFnZVlPZmZzZXQgPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWwuc3R5bGUudG9wID0gdGhpcy53aW5kb3cgLSBwYWdlWU9mZnNldCArICdweCc7XHJcbiAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmVsLnN0eWxlLnRvcCA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgc2Nyb2xsTnVtYmVyKCkge1xyXG4gICAgICAgIGlmKHRoaXMudW5pdCA9PSAncHgnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRvcCA+PSAwID8gdGhpcy50b3AgOiAwO1xyXG4gICAgICAgIH1lbHNlIGlmKHRoaXMudW5pdCA9PSAnJScgfHwgdGhpcy51bml0ID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYWxjKHdpbmRvdy5pbm5lckhlaWdodCx0aGlzLnRvcCkgLSB0aGlzLmVsLmNsaWVudEhlaWdodDtcclxuICAgICAgICB9IFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjYWxjKGhlaWdodCx0b3ApIHtcclxuICAgICAgcmV0dXJuICBoZWlnaHQgKiB0b3AgLyAxMDA7XHJcbiAgICB9XHJcbiAgICBcclxufVxyXG5cclxuXHJcbmxldCBteVNjcm9sbCA9IG5ldyBTQ1JPTEwoe1xyXG4gICAgZWw6ICcuaGVhZGVyX19uYXYnLFxyXG4gICAgdW5pdDogJ3B4J1xyXG59KVxyXG5sZXQgYnVyZ2VyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9fYnVyZ2VyJyksXHJcbiAgICBsaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9fbmF2LWxpc3QnKSxcclxuICAgIGJnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJnJyk7XHJcblxyXG5cclxuYnVyZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICBsaXN0LmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpO1xyXG4gICAgYnVyZ2VyLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpO1xyXG4gICAgYmcuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJylcclxuICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcclxuICAgIGlmKCFidXJnZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSkge1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAndmlzaWJsZSc7XHJcbiAgICB9XHJcbn0pXHJcblxyXG5iZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgbGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxyXG4gICAgYnVyZ2VyLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXHJcbiAgICBiZy5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxyXG4gICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICd2aXNpYmxlJztcclxufSlcclxuXHJcbmxldCBwcmV2aWV3QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByZXZpZXdfX2J0bicpLFxyXG4gICAgdmlkZW9CZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlbycpLFxyXG4gICAgdmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX2ZpbG0nKSxcclxuICAgIHZpZGVvQ2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX2Nsb3NlJyksXHJcbiAgICB2b2x1bWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJvbHNfX3ZvbHVtZScpLFxyXG4gICAgdmlkZW9DdXJyZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX19jdXJyZW50JyksXHJcbiAgICB2aWRlb0R1cmF0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX19kdXJhdGlvbicpLFxyXG4gICAgdmlkZW9Qcm9ncmVzcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cm9sc19fcHJvZ3Jlc3MnKSxcclxuICAgIHZpZGVvRmlsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cm9sc19fZmlsbCcpLFxyXG4gICAgdmlkZW9SdWxlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cm9sc19fcnVsZXInKTtcclxuXHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cm9sc19fcGxheScpLm9uY2xpY2sgPSB2aWRlb1BsYXk7XHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cm9sc19fcGF1c2UnKS5vbmNsaWNrID0gdmlkZW9QYXVzZTtcclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX19zdG9wJykub25jbGljayA9IHZpZGVvU3RvcDtcclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX19zbG93Jykub25jbGljayA9IHNwZWVkRG93bjtcclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX19ub3JtYWwnKS5vbmNsaWNrID0gc3BlZWROb3JtYWw7XHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cm9sc19fZmFzdCcpLm9uY2xpY2sgPSBzcGVlZFVwO1xyXG5cclxuXHJcbi8vINCy0LrQu9GO0YfQtdC90LjQtSDQstC40LTQtdC+XHJcblxyXG5cclxucHJldmlld0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIHZpZGVvQmcuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICB2aWRlby5jdXJyZW50VGltZSA9IDA7XHJcbiAgICB2aWRlby5tdXRlZCA9IGZhbHNlO1xyXG4gICAgdmlkZW8ucGF1c2UoKTtcclxuICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcclxufSlcclxuXHJcbi8vINC30LDQutGA0YvRgtC40LUg0L3QsCB4XHJcblxyXG52aWRlb0Nsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICB2aWRlb0JnLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICd2aXNpYmxlJztcclxuICAgIHZpZGVvLm11dGVkID0gdHJ1ZTtcclxuICAgIHNwZWVkTm9ybWFsKCk7XHJcbn0pXHJcblxyXG4vLyDQt9Cw0LrRgNGL0YLQuNC1INC90LAgZXNjXHJcblxyXG5kb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgIGlmKHZpZGVvQmcuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSkge1xyXG4gICAgICAgIGlmIChldmVudC53aGljaCA9PSAnMjcnKSB7XHJcbiAgICAgICAgICAgIHZpZGVvQmcuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIHZpZGVvLm11dGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvd1kgPSAndmlzaWJsZSdcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pXHJcblxyXG4vLyDQv9Cw0YPQt9CwIC8g0LLQvtC30L7QsdC90L7QstC70LXQvdC40LUg0L3QsCBzcGFjZVxyXG5cclxuXHJcbmRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICBpZih2aWRlb0JnLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpIHtcclxuICAgICAgICBpZihlLmNvZGUgPT0gJ1NwYWNlJykge1xyXG4gICAgICAgICAgICBpZih2aWRlby5wYXVzZWQpIHZpZGVvUGxheSgpO1xyXG4gICAgICAgICAgICBlbHNlICB2aWRlb1BhdXNlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgIH1cclxufSlcclxuXHJcblxyXG4vLyBtdXRlIC8gdW5tdXRlXHJcblxyXG5cclxubGV0IGNWID0gJ2NvbnRyb2xzX192b2x1bWUnLFxyXG5jVlMgPSAnY29udHJvbHNfX3ZvbHVtZS1zbGFzaCc7XHJcblxyXG52b2x1bWUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgIGlmKHZvbHVtZS5jbGFzc0xpc3QuY29udGFpbnMoY1YpKSB7XHJcbiAgICAgICAgdmlkZW8ubXV0ZWQgPSB0cnVlXHJcbiAgICAgICAgdm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoY1YpXHJcbiAgICAgICAgdm9sdW1lLmNsYXNzTGlzdC5hZGQoY1ZTKVxyXG4gICAgfWVsc2Uge1xyXG4gICAgICAgIHZpZGVvLm11dGVkID0gZmFsc2U7XHJcbiAgICAgICAgdm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoY1ZTKVxyXG4gICAgICAgIHZvbHVtZS5jbGFzc0xpc3QuYWRkKGNWKVxyXG4gICAgfVxyXG59KVxyXG5cclxuXHJcblxyXG52aWRlby5vbmRibGNsaWNrID0gKCkgPT4gdmlkZW8ucGF1c2VkID8gdmlkZW8ucGxheSgpIDogdmlkZW8ucGF1c2UoKTtcclxuXHJcblxyXG5cclxuXHJcbi8vINC/0L7QutCw0LfQsNGC0Ywg0YLQtdC60YPRidC10LUg0LLRgNC10LzRj1xyXG5cclxubGV0IGFkZFplcm8gPSBudW0gPT4gbnVtIDwgMTAgPyAnMCcgKyBudW0gOiBudW07XHJcbmxldCB0cmFuc2xhdGVUaW1lID0gdGltZSA9PiBgJHtNYXRoLnRydW5jKCB0aW1lIC8gMzYwMCl9OiR7YWRkWmVybyhNYXRoLnRydW5jKHRpbWUgLyA2MCkpfToke2FkZFplcm8oTWF0aC50cnVuYyh0aW1lKSAlIDYwICl9YDtcclxubGV0IGN1cnJlbnRDaGFuZ2VUaW1lID0gKCkgPT4gdmlkZW9DdXJyZW50LmlubmVySFRNTCA9IHRyYW5zbGF0ZVRpbWUodmlkZW8uY3VycmVudFRpbWUpO1xyXG5cclxuXHJcbnZpZGVvLm9udGltZXVwZGF0ZSA9ICgpID0+IHtcclxuICAgIHZpZGVvRmlsbC5zdHlsZS53aWR0aCA9IGAke3ZpZGVvLmN1cnJlbnRUaW1lIC8gKHZpZGVvLmR1cmF0aW9uIC8gMTAwKX0lYDtcclxuICAgIGN1cnJlbnRDaGFuZ2VUaW1lKClcclxufVxyXG5cclxuLy8g0L/QtdGA0LXQvNC+0YLQutCwXHJcblxyXG52aWRlb1Byb2dyZXNzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgaWYoZS50YXJnZXQgIT0gdmlkZW9SdWxlcikge1xyXG4gICAgICAgIHZpZGVvRmlsbC5zdHlsZS53aWR0aCA9IGAke2Uub2Zmc2V0WH1weGBcclxuICAgICAgICBsZXQgZHVyYXRpb25Qcm9ncmVzcyA9IGUub2Zmc2V0WCAvIHZpZGVvUHJvZ3Jlc3MuY2xpZW50V2lkdGg7XHJcbiAgICAgICAgdmlkZW8uY3VycmVudFRpbWUgPSAgIHZpZGVvLmR1cmF0aW9uICogZHVyYXRpb25Qcm9ncmVzcztcclxuICAgIH1cclxufSlcclxuXHJcblxyXG5cclxuXHJcblxyXG4vLyBwbGF5LCBwYXVzZSwgc3RvcCAsc3BlZWREb3duLCBzcGVlZE5vcm1hbCwgc3BlZWRVcFxyXG5cclxuZnVuY3Rpb24gdmlkZW9QbGF5KCkge1xyXG4gICAgdmlkZW8ucGxheSgpO1xyXG4gICAgdmlkZW9EdXJhdGlvbi5pbm5lckhUTUwgPSB0cmFuc2xhdGVUaW1lKHZpZGVvLmR1cmF0aW9uKTtcclxufVxyXG5mdW5jdGlvbiB2aWRlb1BhdXNlKCkge1xyXG4gICAgdmlkZW8ucGF1c2UoKTtcclxufVxyXG5mdW5jdGlvbiB2aWRlb1N0b3AoKSB7XHJcbiAgICB2aWRlby5wYXVzZSgpO1xyXG4gICAgdmlkZW8uY3VycmVudFRpbWUgPSAwO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzcGVlZERvd24gKCkge1xyXG4gICAgdmlkZW8ucGxheSgpO1xyXG4gICAgdmlkZW8ucGxheWJhY2tSYXRlID0gMC41O1xyXG59XHJcbmZ1bmN0aW9uIHNwZWVkTm9ybWFsICgpIHtcclxuICAgIHZpZGVvLnBsYXkoKTtcclxuICAgIHZpZGVvLnBsYXliYWNrUmF0ZSA9IDE7XHJcbn1cclxuZnVuY3Rpb24gc3BlZWRVcCAoKSB7XHJcbiAgICB2aWRlby5wbGF5KCk7XHJcbiAgICB2aWRlby5wbGF5YmFja1JhdGUgPSAyO1xyXG59IiwibGV0IHByZXZpZXdCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJldmlld19fYnRuJyksXHJcbiAgICB2aWRlb0JnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZGVvJyksXHJcbiAgICB2aWRlbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fZmlsbScpLFxyXG4gICAgdmlkZW9DbG9zZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fY2xvc2UnKSxcclxuICAgIHZvbHVtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cm9sc19fdm9sdW1lJyksXHJcbiAgICB2aWRlb0N1cnJlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJvbHNfX2N1cnJlbnQnKSxcclxuICAgIHZpZGVvRHVyYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJvbHNfX2R1cmF0aW9uJyksXHJcbiAgICB2aWRlb1Byb2dyZXNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX19wcm9ncmVzcycpLFxyXG4gICAgdmlkZW9GaWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX19maWxsJyksXHJcbiAgICB2aWRlb1J1bGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX19ydWxlcicpO1xyXG5cclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX19wbGF5Jykub25jbGljayA9IHZpZGVvUGxheTtcclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX19wYXVzZScpLm9uY2xpY2sgPSB2aWRlb1BhdXNlO1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJvbHNfX3N0b3AnKS5vbmNsaWNrID0gdmlkZW9TdG9wO1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJvbHNfX3Nsb3cnKS5vbmNsaWNrID0gc3BlZWREb3duO1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJvbHNfX25vcm1hbCcpLm9uY2xpY2sgPSBzcGVlZE5vcm1hbDtcclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX19mYXN0Jykub25jbGljayA9IHNwZWVkVXA7XHJcblxyXG5cclxuLy8g0LLQutC70Y7Rh9C10L3QuNC1INCy0LjQtNC10L5cclxuXHJcblxyXG5wcmV2aWV3QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdmlkZW9CZy5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgIHZpZGVvLmN1cnJlbnRUaW1lID0gMDtcclxuICAgIHZpZGVvLm11dGVkID0gZmFsc2U7XHJcbiAgICB2aWRlby5wYXVzZSgpO1xyXG4gICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xyXG59KVxyXG5cclxuLy8g0LfQsNC60YDRi9GC0LjQtSDQvdCwIHhcclxuXHJcbnZpZGVvQ2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgIHZpZGVvQmcuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJ3Zpc2libGUnO1xyXG4gICAgdmlkZW8ubXV0ZWQgPSB0cnVlO1xyXG4gICAgc3BlZWROb3JtYWwoKTtcclxufSlcclxuXHJcbi8vINC30LDQutGA0YvRgtC40LUg0L3QsCBlc2NcclxuXHJcbmRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgaWYodmlkZW9CZy5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpKSB7XHJcbiAgICAgICAgaWYgKGV2ZW50LndoaWNoID09ICcyNycpIHtcclxuICAgICAgICAgICAgdmlkZW9CZy5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgdmlkZW8ubXV0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93WSA9ICd2aXNpYmxlJ1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSlcclxuXHJcbi8vINC/0LDRg9C30LAgLyDQstC+0LfQvtCx0L3QvtCy0LvQtdC90LjQtSDQvdCwIHNwYWNlXHJcblxyXG5cclxuZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24oZSkge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgIGlmKHZpZGVvQmcuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSkge1xyXG4gICAgICAgIGlmKGUuY29kZSA9PSAnU3BhY2UnKSB7XHJcbiAgICAgICAgICAgIGlmKHZpZGVvLnBhdXNlZCkgdmlkZW9QbGF5KCk7XHJcbiAgICAgICAgICAgIGVsc2UgIHZpZGVvUGF1c2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgfVxyXG59KVxyXG5cclxuXHJcbi8vIG11dGUgLyB1bm11dGVcclxuXHJcblxyXG5sZXQgY1YgPSAnY29udHJvbHNfX3ZvbHVtZScsXHJcbmNWUyA9ICdjb250cm9sc19fdm9sdW1lLXNsYXNoJztcclxuXHJcbnZvbHVtZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgaWYodm9sdW1lLmNsYXNzTGlzdC5jb250YWlucyhjVikpIHtcclxuICAgICAgICB2aWRlby5tdXRlZCA9IHRydWVcclxuICAgICAgICB2b2x1bWUuY2xhc3NMaXN0LnJlbW92ZShjVilcclxuICAgICAgICB2b2x1bWUuY2xhc3NMaXN0LmFkZChjVlMpXHJcbiAgICB9ZWxzZSB7XHJcbiAgICAgICAgdmlkZW8ubXV0ZWQgPSBmYWxzZTtcclxuICAgICAgICB2b2x1bWUuY2xhc3NMaXN0LnJlbW92ZShjVlMpXHJcbiAgICAgICAgdm9sdW1lLmNsYXNzTGlzdC5hZGQoY1YpXHJcbiAgICB9XHJcbn0pXHJcblxyXG5cclxuXHJcbnZpZGVvLm9uZGJsY2xpY2sgPSAoKSA9PiB2aWRlby5wYXVzZWQgPyB2aWRlby5wbGF5KCkgOiB2aWRlby5wYXVzZSgpO1xyXG5cclxuXHJcblxyXG5cclxuLy8g0L/QvtC60LDQt9Cw0YLRjCDRgtC10LrRg9GJ0LXQtSDQstGA0LXQvNGPXHJcblxyXG5sZXQgYWRkWmVybyA9IG51bSA9PiBudW0gPCAxMCA/ICcwJyArIG51bSA6IG51bTtcclxubGV0IHRyYW5zbGF0ZVRpbWUgPSB0aW1lID0+IGAke01hdGgudHJ1bmMoIHRpbWUgLyAzNjAwKX06JHthZGRaZXJvKE1hdGgudHJ1bmModGltZSAvIDYwKSl9OiR7YWRkWmVybyhNYXRoLnRydW5jKHRpbWUpICUgNjAgKX1gO1xyXG5sZXQgY3VycmVudENoYW5nZVRpbWUgPSAoKSA9PiB2aWRlb0N1cnJlbnQuaW5uZXJIVE1MID0gdHJhbnNsYXRlVGltZSh2aWRlby5jdXJyZW50VGltZSk7XHJcblxyXG5cclxudmlkZW8ub250aW1ldXBkYXRlID0gKCkgPT4ge1xyXG4gICAgdmlkZW9GaWxsLnN0eWxlLndpZHRoID0gYCR7dmlkZW8uY3VycmVudFRpbWUgLyAodmlkZW8uZHVyYXRpb24gLyAxMDApfSVgO1xyXG4gICAgY3VycmVudENoYW5nZVRpbWUoKVxyXG59XHJcblxyXG4vLyDQv9C10YDQtdC80L7RgtC60LBcclxuXHJcbnZpZGVvUHJvZ3Jlc3MuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICBpZihlLnRhcmdldCAhPSB2aWRlb1J1bGVyKSB7XHJcbiAgICAgICAgdmlkZW9GaWxsLnN0eWxlLndpZHRoID0gYCR7ZS5vZmZzZXRYfXB4YFxyXG4gICAgICAgIGxldCBkdXJhdGlvblByb2dyZXNzID0gZS5vZmZzZXRYIC8gdmlkZW9Qcm9ncmVzcy5jbGllbnRXaWR0aDtcclxuICAgICAgICB2aWRlby5jdXJyZW50VGltZSA9ICAgdmlkZW8uZHVyYXRpb24gKiBkdXJhdGlvblByb2dyZXNzO1xyXG4gICAgfVxyXG59KVxyXG5cclxuXHJcblxyXG5cclxuXHJcbi8vIHBsYXksIHBhdXNlLCBzdG9wICxzcGVlZERvd24sIHNwZWVkTm9ybWFsLCBzcGVlZFVwXHJcblxyXG5mdW5jdGlvbiB2aWRlb1BsYXkoKSB7XHJcbiAgICB2aWRlby5wbGF5KCk7XHJcbiAgICB2aWRlb0R1cmF0aW9uLmlubmVySFRNTCA9IHRyYW5zbGF0ZVRpbWUodmlkZW8uZHVyYXRpb24pO1xyXG59XHJcbmZ1bmN0aW9uIHZpZGVvUGF1c2UoKSB7XHJcbiAgICB2aWRlby5wYXVzZSgpO1xyXG59XHJcbmZ1bmN0aW9uIHZpZGVvU3RvcCgpIHtcclxuICAgIHZpZGVvLnBhdXNlKCk7XHJcbiAgICB2aWRlby5jdXJyZW50VGltZSA9IDA7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNwZWVkRG93biAoKSB7XHJcbiAgICB2aWRlby5wbGF5KCk7XHJcbiAgICB2aWRlby5wbGF5YmFja1JhdGUgPSAwLjU7XHJcbn1cclxuZnVuY3Rpb24gc3BlZWROb3JtYWwgKCkge1xyXG4gICAgdmlkZW8ucGxheSgpO1xyXG4gICAgdmlkZW8ucGxheWJhY2tSYXRlID0gMTtcclxufVxyXG5mdW5jdGlvbiBzcGVlZFVwICgpIHtcclxuICAgIHZpZGVvLnBsYXkoKTtcclxuICAgIHZpZGVvLnBsYXliYWNrUmF0ZSA9IDI7XHJcbn0iXX0=